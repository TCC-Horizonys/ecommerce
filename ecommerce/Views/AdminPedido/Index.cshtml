@model List<ecommerce.Models.Pedido>

@{
    ViewData["Title"] = "Pedidos";
    int pagIndex = (int)ViewData["PagIndex"];
    int totalPag = (int)ViewData["TotalPag"];
}

<section class="ord-wrap">
    <h3 class="ord-title">Pedidos</h3>

    <div class="ord-card">
        <div class="table-responsive">
            <table class="ord-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>CLIENTE</th>
                        <th>PRODUTO</th>
                        <th>CATEGORIA</th>
                        <th>PREÇO</th>
                        <th>TIPO PAGAMENTO</th>
                        <th>STATUS</th>
                        <th>DATA</th>
                        <th>DETALHES</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var pedido in Model)
                    {
                        var cliente = pedido.Usuario?.Nome ?? "—";
                        // Exibir o primeiro item (ou adapte para somar/concatenar)
                        var item = pedido.Itens?.FirstOrDefault();
                        var prodNome = item?.Produto?.Nome ?? "—";
                        var categoria = item?.Produto?.Categoria ?? "—";
                        var preco = pedido.ValorTotal; // ou item?.Preco ?? 0m;
                        var tipoPag = pedido.MetodoPagamento?.Descricao ?? "—";
                        var status = (pedido.DataPagamento > DateTime.MinValue) ? "PAGO" : "PENDENTE";
                        <tr>
                            <td>@pedido.Id</td>
                            <td class="col-strong">@cliente</td>
                            <td class="col-strong">@prodNome</td>
                            <td>@categoria</td>
                            <td>@preco.ToString("C")</td>
                            <td>@tipoPag</td>
                            <td class="@(status == "PAGO" ? "ok" : "pend")">@status</td>
                            <td>@pedido.DataPedido.ToString("dd/MM/yyyy")</td>
                            <td class="col-acoes">
                                <a class="chip" asp-controller="AdminPedido" asp-action="Detalhes" asp-route-id="@pedido.Id">Ver detalhes</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <nav class="ord-pager">
            <ul>
                @for (int i = 1; i <= totalPag; i++)
                {
                    var ativo = i == pagIndex ? "active" : "";
                    <li class="@ativo"><a href="?pagIndex=@i">@i</a></li>
                }
            </ul>
        </nav>
    </div>
</section>

@section Styles {
    <style>
        :root{
          --bg-parchment:#F3EDE1;   /* fundo da página */
          --card:#F1E8D7;           /* cartão da lista */
          --ink:#1a1a1a;
          --accent:#8a5f43;         /* marrom dos botões */
          --radius:18px;
          --shadow:0 8px 18px rgba(0,0,0,.12);
        }
        .ord-wrap{ background:var(--bg-parchment); padding:16px 10px 26px; }
        .ord-title{
          max-width:1120px; margin:0 auto 8px; font-family:"Cinzel","Cormorant Garamond",serif;
          letter-spacing:.06rem; font-size:1rem; color:var(--ink);
        }
        .ord-card{
          max-width:1120px; margin:0 auto; background:var(--card);
          border:1px solid rgba(0,0,0,.08); border-radius:var(--radius); box-shadow:var(--shadow);
          padding:12px 16px 10px;
        }

        .table-responsive{ width:100%; overflow-x:auto; }
        .ord-table{ width:100%; border-collapse:separate; border-spacing:0 12px; }
        .ord-table thead th{
          text-transform:uppercase; font-family:"Cinzel","Cormorant Garamond",serif; letter-spacing:.06rem;
          color:var(--ink); font-weight:700; font-size:.9rem; padding:6px 10px;
        }
        .ord-table tbody tr{
          background:#efe7d8; border:1px solid rgba(0,0,0,.08); box-shadow:0 2px 8px rgba(0,0,0,.06);
        }
        .ord-table tbody td{ padding:12px 10px; vertical-align:middle; color:var(--ink); }
        .ord-table tbody td.col-strong{ font-weight:600; }
        .ord-table tbody td.ok    { letter-spacing:.04rem; }
        .ord-table tbody td.pend  { letter-spacing:.04rem; color:#8a6d3b; }

        .col-acoes{ white-space:nowrap; text-align:left; }
        .chip{
          display:inline-block; text-decoration:none; background:var(--accent); color:#fff;
          padding:6px 12px; border-radius:10px; font-family:"Cinzel","Cormorant Garamond",serif; letter-spacing:.06rem;
        }
        .chip:hover{ filter:brightness(1.05); }

        .ord-pager{ display:flex; justify-content:center; margin-top:10px; }
        .ord-pager ul{ list-style:none; padding:0; margin:0; display:flex; gap:6px; }
        .ord-pager li a{
          display:inline-block; padding:6px 10px; border:1px solid rgba(0,0,0,.25); border-radius:8px;
          text-decoration:none; color:var(--ink); background:#efe9dd;
        }
        .ord-pager li.active a{ background:#000; color:#fff; border-color:#000; }
    </style>
}
